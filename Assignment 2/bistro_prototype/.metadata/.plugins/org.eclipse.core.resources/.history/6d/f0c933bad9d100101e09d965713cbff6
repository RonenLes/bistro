package application;

import java.io.InputStream;
import java.util.Properties;

import controllers.ClientController;

public class ClientMain {

    public static void main(String[] args) {

        boolean connected = false;
        String host = "localhost";
        String port ="3000"

        try (InputStream input =ClientMain.class.getClassLoader().getResourceAsStream("dbDetailsLaptop.properties")) {
                                                           
            if (input == null) {
                System.err.println("ERROR: Configuration file 'dbDetailsLaptop.properties' not found in the classpath.");
            } else {
                Properties props = new Properties();
                props.load(input);

                String fromFile = props.getProperty("hostIP");
                if (fromFile != null && !fromFile.isBlank()) {
                    host = fromFile.trim();
                }

                System.out.println("Using host from properties: " + host);
            }

        } catch (Exception e) {
            System.err.println("Host IP property loading failed.");           
        }


        BistroClient client = new BistroClient(host, 3000);

        ClientController controller = new ClientController(client);

        client.setClientController(controller);

        try {
            client.openConnection();
            connected = true;
            System.out.println("Connected to server on " + host + ":3000");
        } catch (Exception e) {
            System.out.println("Connection failed: " + e.getMessage());
        }

        ClientUI.startUI(controller, connected);
    }
}
